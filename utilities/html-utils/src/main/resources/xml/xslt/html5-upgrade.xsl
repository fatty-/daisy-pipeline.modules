<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:h="http://www.w3.org/1999/xhtml"
                xmlns:f="http://www.daisy.org/ns/pipeline/internal-functions"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="2.0"
                exclude-result-prefixes="#all">
                
   <xsl:output indent="yes" method="xml"/>
                
   <xsl:template match="/">
      <xsl:for-each select="*|text()|processing-instruction()|comment()">
         <xsl:copy>
            <xsl:apply-templates select="."/>
         </xsl:copy>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template match="text()|processing-instruction()|comment()">
      <xsl:copy-of select="."/>
   </xsl:template>
                
   <xsl:template name="html" match="h:html">
      <xsl:copy-of select="@manifest|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:head|self::h:body|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('head','body')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='head'">
                              <xsl:call-template name="head"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='body'">
                              <xsl:call-template name="body"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('head','body'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="head" match="h:head">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:title|self::h:base|self::h:command|self::h:link|self::h:meta|self::h:noscript|self::h:script|self::h:style|self::h:title|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('title','base','command','link','meta','noscript','script','style','title')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='title'">
                              <xsl:call-template name="title"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='base'">
                              <xsl:call-template name="base"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='link'">
                              <xsl:call-template name="link"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meta'">
                              <xsl:call-template name="meta"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='title'">
                              <xsl:call-template name="title"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('title','base','command','link','meta','noscript','script','style','title'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="title" match="h:title">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="base" match="h:base">
      <xsl:copy-of select="@href|@target|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="link" match="h:link">
      <xsl:copy-of select="@href|@rel|@media|@hreflang|@type|@sizes|@title|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="meta" match="h:meta">
      <xsl:copy-of select="@name|@http-equiv|@content|@charset|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="style" match="h:style">
      <xsl:copy-of select="@type|@media|@type|@scoped|@title|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="script" match="h:script">
      <xsl:copy-of select="@src|@src|@async|@defer|@type|@charset|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="noscript" match="h:noscript">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:head|self::h:link|self::h:style|self::h:meta|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('head','link','style','meta')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='head'">
                              <xsl:call-template name="head"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='link'">
                              <xsl:call-template name="link"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meta'">
                              <xsl:call-template name="meta"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),('head','link','style','meta'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="body" match="h:body">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="article" match="h:article">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="section" match="h:section">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="nav" match="h:nav">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="aside" match="h:aside">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h1" match="h:h1">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h2" match="h:h2">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h3" match="h:h3">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h4" match="h:h4">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h5" match="h:h5">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="h6" match="h:h6">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="hgroup" match="h:hgroup">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('h1','h2','h3','h4','h5','h6')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('h1','h2','h3','h4','h5','h6'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="header" match="h:header">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="footer" match="h:footer">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="address" match="h:address">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="p" match="h:p">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="hr" match="h:hr">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="pre" match="h:pre">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="blockquote" match="h:blockquote">
      <xsl:copy-of select="@cite|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="ol" match="h:ol">
      <xsl:copy-of select="@reversed|@start|@type|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:li|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('li')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='li'">
                              <xsl:call-template name="li"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('li'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="ul" match="h:ul">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:li|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('li')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='li'">
                              <xsl:call-template name="li"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('li'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="li" match="h:li">
      <xsl:copy-of select="@value|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:ol|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('ol','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('ol','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="dl" match="h:dl">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:dt|self::h:dd|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('dt','dd')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='dt'">
                              <xsl:call-template name="dt"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dd'">
                              <xsl:call-template name="dd"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('dt','dd'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="dt" match="h:dt">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="dd" match="h:dd">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="figure" match="h:figure">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:figcaption|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('figcaption','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='figcaption'">
                              <xsl:call-template name="figcaption"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('figcaption','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="figcaption" match="h:figcaption">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="div" match="h:div">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="a" match="h:a">
      <xsl:copy-of select="@href|@target|@rel|@media|@hreflang|@type|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="em" match="h:em">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="strong" match="h:strong">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="small" match="h:small">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="s" match="h:s">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="cite" match="h:cite">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="q" match="h:q">
      <xsl:copy-of select="@cite|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="dfn" match="h:dfn">
      <xsl:copy-of select="@title|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="abbr" match="h:abbr">
      <xsl:copy-of select="@title|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="time" match="h:time">
      <xsl:copy-of select="@datetime|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="code" match="h:code">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="var" match="h:var">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="samp" match="h:samp">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="kbd" match="h:kbd">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="sub" match="h:sub">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="sup" match="h:sup">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="i" match="h:i">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="b" match="h:b">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="u" match="h:u">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="mark" match="h:mark">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="ruby" match="h:ruby">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="rt" match="h:rt">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="rp" match="h:rp">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="bdi" match="h:bdi">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="bdo" match="h:bdo">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="span" match="h:span">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="br" match="h:br">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="wbr" match="h:wbr">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="ins" match="h:ins">
      <xsl:copy-of select="@cite|@datetime|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="del" match="h:del">
      <xsl:copy-of select="@cite|@datetime|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="img" match="h:img">
      <xsl:copy-of select="@alt|@src|@crossorigin|@usemap|@ismap|@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="iframe" match="h:iframe">
      <xsl:copy-of select="@src|@srcdoc|@name|@sandbox|@seamless|@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="embed" match="h:embed">
      <xsl:copy-of select="@src|@type|@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="object" match="h:object">
      <xsl:copy-of select="@data|@type|@typemustmatch|@name|@usemap|@form|@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:param|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::h:a|self::h:audio|self::h:button|self::h:details|self::h:embed|self::h:iframe|self::h:img|self::h:input|self::h:keygen|self::h:label|self::h:menu|self::h:object|self::h:select|self::h:textarea|self::h:video|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('param','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr','a','audio','button','details','embed','iframe','img','input','keygen','label','menu','object','select','textarea','video')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='param'">
                              <xsl:call-template name="param"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('param','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr','a','audio','button','details','embed','iframe','img','input','keygen','label','menu','object','select','textarea','video'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="param" match="h:param">
      <xsl:copy-of select="@name|@value|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="video" match="h:video">
      <xsl:copy-of select="@src|@src|@crossorigin|@poster|@preload|@autoplay|@mediagroup|@loop|@muted|@controls|@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:track|self::h:source|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('track','source')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='track'">
                              <xsl:call-template name="track"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='source'">
                              <xsl:call-template name="source"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),('track','source'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="audio" match="h:audio">
      <xsl:copy-of select="@src|@src|@crossorigin|@preload|@autoplay|@mediagroup|@loop|@muted|@controls|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:track|self::h:source|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('track','source')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='track'">
                              <xsl:call-template name="track"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='source'">
                              <xsl:call-template name="source"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),('track','source'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="source" match="h:source">
      <xsl:copy-of select="@src|@type|@media|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="track" match="h:track">
      <xsl:copy-of select="@kind|@src|@srclang|@label|@default|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="canvas" match="h:canvas">
      <xsl:copy-of select="@width|@height|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="map" match="h:map">
      <xsl:copy-of select="@name|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::* and local-name()=f:recursive-transparency(.)">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="(f:recursive-transparency(.),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="area" match="h:area">
      <xsl:copy-of select="@alt|@coords|@shape|@href|@target|@rel|@media|@hreflang|@type|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="table" match="h:table">
      <xsl:copy-of select="@border|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:caption|self::h:colgroup|self::h:thead|self::h:tfoot|self::h:tbody|self::h:tr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('caption','colgroup','thead','tfoot','tbody','tr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='caption'">
                              <xsl:call-template name="caption"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='colgroup'">
                              <xsl:call-template name="colgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='thead'">
                              <xsl:call-template name="thead"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='tfoot'">
                              <xsl:call-template name="tfoot"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='tbody'">
                              <xsl:call-template name="tbody"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='tr'">
                              <xsl:call-template name="tr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('caption','colgroup','thead','tfoot','tbody','tr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="caption" match="h:caption">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="colgroup" match="h:colgroup">
      <xsl:copy-of select="@span|@span|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:col|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('col')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='col'">
                              <xsl:call-template name="col"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('col'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="col" match="h:col">
      <xsl:copy-of select="@span|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="tbody" match="h:tbody">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:tr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('tr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='tr'">
                              <xsl:call-template name="tr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('tr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="thead" match="h:thead">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:tr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('tr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='tr'">
                              <xsl:call-template name="tr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('tr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="tfoot" match="h:tfoot">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:tr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('tr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='tr'">
                              <xsl:call-template name="tr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('tr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="tr" match="h:tr">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:td|self::h:th|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('td','th')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='td'">
                              <xsl:call-template name="td"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='th'">
                              <xsl:call-template name="th"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('td','th'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="td" match="h:td">
      <xsl:copy-of select="@colspan|@rowspan|@headers|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="th" match="h:th">
      <xsl:copy-of select="@colspan|@rowspan|@headers|@scope|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="form" match="h:form">
      <xsl:copy-of select="@accept-charset|@action|@autocomplete|@enctype|@method|@name|@novalidate|@target|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="fieldset" match="h:fieldset">
      <xsl:copy-of select="@disabled|@form|@name|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:legend|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('legend','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='legend'">
                              <xsl:call-template name="legend"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('legend','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="legend" match="h:legend">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="label" match="h:label">
      <xsl:copy-of select="@form|@for|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="input" match="h:input">
      <xsl:copy-of select="@accept|@alt|@autocomplete|@autofocus|@checked|@dirname|@disabled|@form|@formaction|@formenctype|@formmethod|@formnovalidate|@formtarget|@height|@list|@max|@maxlength|@min|@multiple|@name|@pattern|@placeholder|@readonly|@required|@size|@src|@step|@type|@value|@width|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="button" match="h:button">
      <xsl:copy-of select="@autofocus|@disabled|@form|@formaction|@formenctype|@formmethod|@formnovalidate|@formtarget|@name|@type|@value|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="select" match="h:select">
      <xsl:copy-of select="@autofocus|@disabled|@form|@multiple|@name|@required|@size|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:option|self::h:optgroup|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('option','optgroup')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='option'">
                              <xsl:call-template name="option"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='optgroup'">
                              <xsl:call-template name="optgroup"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('option','optgroup'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="datalist" match="h:datalist">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:option|self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('option','a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='option'">
                              <xsl:call-template name="option"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('option','a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="optgroup" match="h:optgroup">
      <xsl:copy-of select="@disabled|@label|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:option|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('option')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='option'">
                              <xsl:call-template name="option"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),('option'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="option" match="h:option">
      <xsl:copy-of select="@disabled|@label|@selected|@value|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="textarea" match="h:textarea">
      <xsl:copy-of select="@autofocus|@cols|@dirname|@disabled|@form|@maxlength|@name|@placeholder|@readonly|@required|@rows|@wrap|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="keygen" match="h:keygen">
      <xsl:copy-of select="@autofocus|@challenge|@disabled|@form|@keytype|@name|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="output" match="h:output">
      <xsl:copy-of select="@for|@form|@name|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="progress" match="h:progress">
      <xsl:copy-of select="@value|@max|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="meter" match="h:meter">
      <xsl:copy-of select="@value|@min|@max|@low|@high|@optimum|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="details" match="h:details">
      <xsl:copy-of select="@open|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:summary|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('summary','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='summary'">
                              <xsl:call-template name="summary"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('summary','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="summary" match="h:summary">
      <xsl:copy-of select="@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:area|self::h:map|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:dfn|self::h:em|self::h:embed|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:meter|self::h:noscript|self::h:object|self::h:output|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:sub|self::h:sup|self::h:textarea|self::h:time|self::h:u|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="command" match="h:command">
      <xsl:copy-of select="@type|@label|@icon|@disabled|@checked|@radiogroup|@command|@title|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:apply-templates select="text()|comment()"/>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements" select="((),())"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="menu" match="h:menu">
      <xsl:copy-of select="@type|@label|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:li|self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('li','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='li'">
                              <xsl:call-template name="li"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('li','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:template name="dialog" match="h:dialog">
      <xsl:copy-of select="@open|@class|@accesskey|@contenteditable|@contextmenu|@dir|@draggable|@dropzone|@hidden|@id|@lang|@spellcheck|@style|@tabindex|@title|@translate|@onabort|@onblur|@oncancel|@oncanplay|@oncanplaythrough|@onchange|@onclick|@onclose|@oncontextmenu|@oncuechange|@ondblclick|@ondrag|@ondragend|@ondragenter|@ondragleave|@ondragover|@ondragstart|@ondrop|@ondurationchange|@onemptied|@onended|@onerror|@onfocus|@oninput|@oninvalid|@onkeydown|@onkeypress|@onkeyup|@onload|@onloadeddata|@onloadedmetadata|@onloadstart|@onmousedown|@onmousemove|@onmouseout|@onmouseover|@onmouseup|@onmousewheel|@onpause|@onplay|@onplaying|@onprogress|@onratechange|@onreset|@onscroll|@onseeked|@onseeking|@onselect|@onshow|@onstalled|@onsubmit|@onsuspend|@ontimeupdate|@onvolumechange|@onwaiting|@*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml')) or starts-with(local-name(),'data-')]"/>
      <xsl:for-each select="*|text()|comment()">
         <xsl:choose>
            <xsl:when test="self::h:a|self::h:abbr|self::h:address|self::h:area|self::h:map|self::h:article|self::h:aside|self::h:audio|self::h:b|self::h:bdi|self::h:bdo|self::h:blockquote|self::h:br|self::h:button|self::h:canvas|self::h:cite|self::h:code|self::h:command|self::h:datalist|self::h:del|self::h:details|self::h:dfn|self::h:dialog|self::h:div|self::h:dl|self::h:em|self::h:embed|self::h:fieldset|self::h:figure|self::h:footer|self::h:form|self::h:h1|self::h:h2|self::h:h3|self::h:h4|self::h:h5|self::h:h6|self::h:header|self::h:hgroup|self::h:hr|self::h:i|self::h:iframe|self::h:img|self::h:input|self::h:ins|self::h:kbd|self::h:keygen|self::h:label|self::h:mark|self::h:menu|self::h:meter|self::h:nav|self::h:noscript|self::h:object|self::h:ol|self::h:output|self::h:p|self::h:pre|self::h:progress|self::h:q|self::h:ruby|self::h:s|self::h:samp|self::h:script|self::h:section|self::h:select|self::h:small|self::h:span|self::h:strong|self::h:style|self::h:sub|self::h:sup|self::h:table|self::h:textarea|self::h:time|self::h:u|self::h:ul|self::h:var|self::h:video|self::h:wbr|self::*[not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))]">
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:when>
            <xsl:when test="self::*">
               <xsl:variable name="replaceWith"
                             select="if (not(namespace-uri()=('','http://www.w3.org/1999/xhtml'))) then '' else if (local-name()='applet') then 'object' else if (local-name()='acronym') then 'abbr' else if (local-name()='bgsound') then 'audio' else if (local-name()='dir') then 'ul' else if (local-name()='frame') then 'iframe' else if (local-name()='frameset') then 'div' else if (local-name()='noframes') then 'div' else if (local-name()='listing') then 'pre' else if (local-name()='noembed') then 'object' else if (local-name()='strike') then 's' else if (local-name()='xmp') then 'code' else ''"/>
               <xsl:choose>
                  <xsl:when test="namespace-uri()=('','http://www.w3.org/1999/xhtml') and not($replaceWith='') and $replaceWith=('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr')">
                     <xsl:element name="{$replaceWith}" namespace="http://www.w3.org/1999/xhtml">
                        <xsl:choose>
                           <xsl:when test="$replaceWith='a'">
                              <xsl:call-template name="a"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='abbr'">
                              <xsl:call-template name="abbr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='address'">
                              <xsl:call-template name="address"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='area'">
                              <xsl:call-template name="area"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='map'">
                              <xsl:call-template name="map"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='article'">
                              <xsl:call-template name="article"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='aside'">
                              <xsl:call-template name="aside"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='audio'">
                              <xsl:call-template name="audio"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='b'">
                              <xsl:call-template name="b"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdi'">
                              <xsl:call-template name="bdi"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='bdo'">
                              <xsl:call-template name="bdo"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='blockquote'">
                              <xsl:call-template name="blockquote"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='br'">
                              <xsl:call-template name="br"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='button'">
                              <xsl:call-template name="button"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='canvas'">
                              <xsl:call-template name="canvas"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='cite'">
                              <xsl:call-template name="cite"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='code'">
                              <xsl:call-template name="code"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='command'">
                              <xsl:call-template name="command"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='datalist'">
                              <xsl:call-template name="datalist"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='del'">
                              <xsl:call-template name="del"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='details'">
                              <xsl:call-template name="details"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dfn'">
                              <xsl:call-template name="dfn"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dialog'">
                              <xsl:call-template name="dialog"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='div'">
                              <xsl:call-template name="div"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='dl'">
                              <xsl:call-template name="dl"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='em'">
                              <xsl:call-template name="em"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='embed'">
                              <xsl:call-template name="embed"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='fieldset'">
                              <xsl:call-template name="fieldset"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='figure'">
                              <xsl:call-template name="figure"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='footer'">
                              <xsl:call-template name="footer"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='form'">
                              <xsl:call-template name="form"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h1'">
                              <xsl:call-template name="h1"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h2'">
                              <xsl:call-template name="h2"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h3'">
                              <xsl:call-template name="h3"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h4'">
                              <xsl:call-template name="h4"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h5'">
                              <xsl:call-template name="h5"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='h6'">
                              <xsl:call-template name="h6"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='header'">
                              <xsl:call-template name="header"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hgroup'">
                              <xsl:call-template name="hgroup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='hr'">
                              <xsl:call-template name="hr"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='i'">
                              <xsl:call-template name="i"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='iframe'">
                              <xsl:call-template name="iframe"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='img'">
                              <xsl:call-template name="img"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='input'">
                              <xsl:call-template name="input"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ins'">
                              <xsl:call-template name="ins"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='kbd'">
                              <xsl:call-template name="kbd"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='keygen'">
                              <xsl:call-template name="keygen"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='label'">
                              <xsl:call-template name="label"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='mark'">
                              <xsl:call-template name="mark"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='menu'">
                              <xsl:call-template name="menu"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='meter'">
                              <xsl:call-template name="meter"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='nav'">
                              <xsl:call-template name="nav"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='noscript'">
                              <xsl:call-template name="noscript"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='object'">
                              <xsl:call-template name="object"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ol'">
                              <xsl:call-template name="ol"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='output'">
                              <xsl:call-template name="output"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='p'">
                              <xsl:call-template name="p"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='pre'">
                              <xsl:call-template name="pre"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='progress'">
                              <xsl:call-template name="progress"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='q'">
                              <xsl:call-template name="q"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ruby'">
                              <xsl:call-template name="ruby"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='s'">
                              <xsl:call-template name="s"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='samp'">
                              <xsl:call-template name="samp"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='script'">
                              <xsl:call-template name="script"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='section'">
                              <xsl:call-template name="section"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='select'">
                              <xsl:call-template name="select"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='small'">
                              <xsl:call-template name="small"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='span'">
                              <xsl:call-template name="span"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='strong'">
                              <xsl:call-template name="strong"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='style'">
                              <xsl:call-template name="style"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sub'">
                              <xsl:call-template name="sub"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='sup'">
                              <xsl:call-template name="sup"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='table'">
                              <xsl:call-template name="table"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='textarea'">
                              <xsl:call-template name="textarea"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='time'">
                              <xsl:call-template name="time"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='u'">
                              <xsl:call-template name="u"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='ul'">
                              <xsl:call-template name="ul"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='var'">
                              <xsl:call-template name="var"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='video'">
                              <xsl:call-template name="video"/>
                           </xsl:when>
                           <xsl:when test="$replaceWith='wbr'">
                              <xsl:call-template name="wbr"/>
                           </xsl:when>
                           <xsl:otherwise>
                              <xsl:apply-templates select="text()|comment()"/>
                           </xsl:otherwise>
                        </xsl:choose>
                     </xsl:element>
                  </xsl:when>
                  <xsl:otherwise>
                     <xsl:variable name="transparentAllowedElements"
                                   select="((),('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
                     <xsl:choose>
                        <xsl:when test="'div'=$transparentAllowedElements">
                           <div xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="div"/>
                           </div>
                        </xsl:when>
                        <xsl:when test="'span'=$transparentAllowedElements">
                           <span xmlns="http://www.w3.org/1999/xhtml">
                              <xsl:call-template name="span"/>
                           </span>
                        </xsl:when>
                        <xsl:when test="count($transparentAllowedElements) &gt; 0">
                           <xsl:element name="{($transparentAllowedElements)[1]}"
                                        namespace="http://www.w3.org/1999/xhtml">
                              <xsl:choose>
                                 <xsl:when test="'html'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="html"/>
                                 </xsl:when>
                                 <xsl:when test="'head'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="head"/>
                                 </xsl:when>
                                 <xsl:when test="'title'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="title"/>
                                 </xsl:when>
                                 <xsl:when test="'base'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="base"/>
                                 </xsl:when>
                                 <xsl:when test="'link'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="link"/>
                                 </xsl:when>
                                 <xsl:when test="'meta'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meta"/>
                                 </xsl:when>
                                 <xsl:when test="'style'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="style"/>
                                 </xsl:when>
                                 <xsl:when test="'script'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="script"/>
                                 </xsl:when>
                                 <xsl:when test="'noscript'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="noscript"/>
                                 </xsl:when>
                                 <xsl:when test="'body'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="body"/>
                                 </xsl:when>
                                 <xsl:when test="'article'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="article"/>
                                 </xsl:when>
                                 <xsl:when test="'section'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="section"/>
                                 </xsl:when>
                                 <xsl:when test="'nav'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="nav"/>
                                 </xsl:when>
                                 <xsl:when test="'aside'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="aside"/>
                                 </xsl:when>
                                 <xsl:when test="'h1'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h1"/>
                                 </xsl:when>
                                 <xsl:when test="'h2'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h2"/>
                                 </xsl:when>
                                 <xsl:when test="'h3'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h3"/>
                                 </xsl:when>
                                 <xsl:when test="'h4'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h4"/>
                                 </xsl:when>
                                 <xsl:when test="'h5'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h5"/>
                                 </xsl:when>
                                 <xsl:when test="'h6'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="h6"/>
                                 </xsl:when>
                                 <xsl:when test="'hgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'header'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="header"/>
                                 </xsl:when>
                                 <xsl:when test="'footer'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="footer"/>
                                 </xsl:when>
                                 <xsl:when test="'address'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="address"/>
                                 </xsl:when>
                                 <xsl:when test="'p'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="p"/>
                                 </xsl:when>
                                 <xsl:when test="'hr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="hr"/>
                                 </xsl:when>
                                 <xsl:when test="'pre'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="pre"/>
                                 </xsl:when>
                                 <xsl:when test="'blockquote'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="blockquote"/>
                                 </xsl:when>
                                 <xsl:when test="'ol'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ol"/>
                                 </xsl:when>
                                 <xsl:when test="'ul'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ul"/>
                                 </xsl:when>
                                 <xsl:when test="'li'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="li"/>
                                 </xsl:when>
                                 <xsl:when test="'dl'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dl"/>
                                 </xsl:when>
                                 <xsl:when test="'dt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dt"/>
                                 </xsl:when>
                                 <xsl:when test="'dd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dd"/>
                                 </xsl:when>
                                 <xsl:when test="'figure'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figure"/>
                                 </xsl:when>
                                 <xsl:when test="'figcaption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="figcaption"/>
                                 </xsl:when>
                                 <xsl:when test="'div'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="div"/>
                                 </xsl:when>
                                 <xsl:when test="'a'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="a"/>
                                 </xsl:when>
                                 <xsl:when test="'em'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="em"/>
                                 </xsl:when>
                                 <xsl:when test="'strong'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="strong"/>
                                 </xsl:when>
                                 <xsl:when test="'small'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="small"/>
                                 </xsl:when>
                                 <xsl:when test="'s'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="s"/>
                                 </xsl:when>
                                 <xsl:when test="'cite'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="cite"/>
                                 </xsl:when>
                                 <xsl:when test="'q'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="q"/>
                                 </xsl:when>
                                 <xsl:when test="'dfn'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dfn"/>
                                 </xsl:when>
                                 <xsl:when test="'abbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="abbr"/>
                                 </xsl:when>
                                 <xsl:when test="'time'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="time"/>
                                 </xsl:when>
                                 <xsl:when test="'code'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="code"/>
                                 </xsl:when>
                                 <xsl:when test="'var'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="var"/>
                                 </xsl:when>
                                 <xsl:when test="'samp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="samp"/>
                                 </xsl:when>
                                 <xsl:when test="'kbd'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="kbd"/>
                                 </xsl:when>
                                 <xsl:when test="'sub'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sub"/>
                                 </xsl:when>
                                 <xsl:when test="'sup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="sup"/>
                                 </xsl:when>
                                 <xsl:when test="'i'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="i"/>
                                 </xsl:when>
                                 <xsl:when test="'b'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="b"/>
                                 </xsl:when>
                                 <xsl:when test="'u'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="u"/>
                                 </xsl:when>
                                 <xsl:when test="'mark'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="mark"/>
                                 </xsl:when>
                                 <xsl:when test="'ruby'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ruby"/>
                                 </xsl:when>
                                 <xsl:when test="'rt'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rt"/>
                                 </xsl:when>
                                 <xsl:when test="'rp'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="rp"/>
                                 </xsl:when>
                                 <xsl:when test="'bdi'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdi"/>
                                 </xsl:when>
                                 <xsl:when test="'bdo'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="bdo"/>
                                 </xsl:when>
                                 <xsl:when test="'span'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="span"/>
                                 </xsl:when>
                                 <xsl:when test="'br'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="br"/>
                                 </xsl:when>
                                 <xsl:when test="'wbr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="wbr"/>
                                 </xsl:when>
                                 <xsl:when test="'ins'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="ins"/>
                                 </xsl:when>
                                 <xsl:when test="'del'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="del"/>
                                 </xsl:when>
                                 <xsl:when test="'img'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="img"/>
                                 </xsl:when>
                                 <xsl:when test="'iframe'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="iframe"/>
                                 </xsl:when>
                                 <xsl:when test="'embed'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="embed"/>
                                 </xsl:when>
                                 <xsl:when test="'object'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="object"/>
                                 </xsl:when>
                                 <xsl:when test="'param'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="param"/>
                                 </xsl:when>
                                 <xsl:when test="'video'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="video"/>
                                 </xsl:when>
                                 <xsl:when test="'audio'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="audio"/>
                                 </xsl:when>
                                 <xsl:when test="'source'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="source"/>
                                 </xsl:when>
                                 <xsl:when test="'track'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="track"/>
                                 </xsl:when>
                                 <xsl:when test="'canvas'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="canvas"/>
                                 </xsl:when>
                                 <xsl:when test="'map'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="map"/>
                                 </xsl:when>
                                 <xsl:when test="'area'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="area"/>
                                 </xsl:when>
                                 <xsl:when test="'table'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="table"/>
                                 </xsl:when>
                                 <xsl:when test="'caption'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="caption"/>
                                 </xsl:when>
                                 <xsl:when test="'colgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="colgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'col'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="col"/>
                                 </xsl:when>
                                 <xsl:when test="'tbody'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tbody"/>
                                 </xsl:when>
                                 <xsl:when test="'thead'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="thead"/>
                                 </xsl:when>
                                 <xsl:when test="'tfoot'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tfoot"/>
                                 </xsl:when>
                                 <xsl:when test="'tr'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="tr"/>
                                 </xsl:when>
                                 <xsl:when test="'td'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="td"/>
                                 </xsl:when>
                                 <xsl:when test="'th'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="th"/>
                                 </xsl:when>
                                 <xsl:when test="'form'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="form"/>
                                 </xsl:when>
                                 <xsl:when test="'fieldset'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="fieldset"/>
                                 </xsl:when>
                                 <xsl:when test="'legend'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="legend"/>
                                 </xsl:when>
                                 <xsl:when test="'label'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="label"/>
                                 </xsl:when>
                                 <xsl:when test="'input'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="input"/>
                                 </xsl:when>
                                 <xsl:when test="'button'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="button"/>
                                 </xsl:when>
                                 <xsl:when test="'select'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="select"/>
                                 </xsl:when>
                                 <xsl:when test="'datalist'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="datalist"/>
                                 </xsl:when>
                                 <xsl:when test="'optgroup'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="optgroup"/>
                                 </xsl:when>
                                 <xsl:when test="'option'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="option"/>
                                 </xsl:when>
                                 <xsl:when test="'textarea'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="textarea"/>
                                 </xsl:when>
                                 <xsl:when test="'keygen'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="keygen"/>
                                 </xsl:when>
                                 <xsl:when test="'output'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="output"/>
                                 </xsl:when>
                                 <xsl:when test="'progress'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="progress"/>
                                 </xsl:when>
                                 <xsl:when test="'meter'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="meter"/>
                                 </xsl:when>
                                 <xsl:when test="'details'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="details"/>
                                 </xsl:when>
                                 <xsl:when test="'summary'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="summary"/>
                                 </xsl:when>
                                 <xsl:when test="'command'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="command"/>
                                 </xsl:when>
                                 <xsl:when test="'menu'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="menu"/>
                                 </xsl:when>
                                 <xsl:when test="'dialog'=($transparentAllowedElements)[1]">
                                    <xsl:call-template name="dialog"/>
                                 </xsl:when>
                              </xsl:choose>
                           </xsl:element>
                        </xsl:when>
                        <xsl:otherwise>
                           <xsl:apply-templates select="text()|comment()"/>
                        </xsl:otherwise>
                     </xsl:choose>
                  </xsl:otherwise>
               </xsl:choose>
            </xsl:when>
            <xsl:otherwise>
               <xsl:copy>
                  <xsl:apply-templates select="."/>
               </xsl:copy>
            </xsl:otherwise>
         </xsl:choose>
      </xsl:for-each>
   </xsl:template>
                
   <xsl:function name="f:recursive-transparency">
      <xsl:param name="element"/>
      <xsl:variable name="name" select="local-name($element)"/>
      <xsl:choose>
         <xsl:when test="$name='html'">
            <xsl:sequence select="(()),(('head','body'))"/>
         </xsl:when>
         <xsl:when test="$name='head'">
            <xsl:sequence select="(()),(('title','base','command','link','meta','noscript','script','style','title'))"/>
         </xsl:when>
         <xsl:when test="$name='title'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='base'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='link'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='meta'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='style'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='script'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='noscript'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(('head','link','style','meta'))"/>
         </xsl:when>
         <xsl:when test="$name='body'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='article'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='section'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='nav'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='aside'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h1'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h2'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h3'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h4'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h5'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='h6'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='hgroup'">
            <xsl:sequence select="(()),(('h1','h2','h3','h4','h5','h6'))"/>
         </xsl:when>
         <xsl:when test="$name='header'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='footer'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='address'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='p'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='hr'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='pre'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='blockquote'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='ol'">
            <xsl:sequence select="(()),(('li'))"/>
         </xsl:when>
         <xsl:when test="$name='ul'">
            <xsl:sequence select="(()),(('li'))"/>
         </xsl:when>
         <xsl:when test="$name='li'">
            <xsl:sequence select="(()),(('ol','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='dl'">
            <xsl:sequence select="(()),(('dt','dd'))"/>
         </xsl:when>
         <xsl:when test="$name='dt'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='dd'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='figure'">
            <xsl:sequence select="(()),(('figcaption','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='figcaption'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='div'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='a'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(())"/>
         </xsl:when>
         <xsl:when test="$name='em'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='strong'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='small'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='s'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='cite'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='q'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='dfn'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='abbr'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='time'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='code'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='var'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='samp'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='kbd'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='sub'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='sup'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='i'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='b'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='u'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='mark'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='ruby'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='rt'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='rp'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='bdi'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='bdo'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='span'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='br'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='wbr'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='ins'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(())"/>
         </xsl:when>
         <xsl:when test="$name='del'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(())"/>
         </xsl:when>
         <xsl:when test="$name='img'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='iframe'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='embed'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='object'">
            <xsl:sequence select="(()),(('param','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr','a','audio','button','details','embed','iframe','img','input','keygen','label','menu','object','select','textarea','video'))"/>
         </xsl:when>
         <xsl:when test="$name='param'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='video'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(('track','source'))"/>
         </xsl:when>
         <xsl:when test="$name='audio'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(('track','source'))"/>
         </xsl:when>
         <xsl:when test="$name='source'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='track'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='canvas'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(())"/>
         </xsl:when>
         <xsl:when test="$name='map'">
            <xsl:sequence select="(f:recursive-transparency($element/..)),(())"/>
         </xsl:when>
         <xsl:when test="$name='area'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='table'">
            <xsl:sequence select="(()),(('caption','colgroup','thead','tfoot','tbody','tr'))"/>
         </xsl:when>
         <xsl:when test="$name='caption'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='colgroup'">
            <xsl:sequence select="(()),(('col'))"/>
         </xsl:when>
         <xsl:when test="$name='col'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='tbody'">
            <xsl:sequence select="(()),(('tr'))"/>
         </xsl:when>
         <xsl:when test="$name='thead'">
            <xsl:sequence select="(()),(('tr'))"/>
         </xsl:when>
         <xsl:when test="$name='tfoot'">
            <xsl:sequence select="(()),(('tr'))"/>
         </xsl:when>
         <xsl:when test="$name='tr'">
            <xsl:sequence select="(()),(('td','th'))"/>
         </xsl:when>
         <xsl:when test="$name='td'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='th'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='form'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='fieldset'">
            <xsl:sequence select="(()),(('legend','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='legend'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='label'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='input'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='button'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='select'">
            <xsl:sequence select="(()),(('option','optgroup'))"/>
         </xsl:when>
         <xsl:when test="$name='datalist'">
            <xsl:sequence select="(()),(('option','a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='optgroup'">
            <xsl:sequence select="(()),(('option'))"/>
         </xsl:when>
         <xsl:when test="$name='option'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='textarea'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='keygen'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='output'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='progress'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='meter'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='details'">
            <xsl:sequence select="(()),(('summary','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='summary'">
            <xsl:sequence select="(()),(('a','abbr','area','map','audio','b','bdi','bdo','br','button','canvas','cite','code','command','datalist','del','dfn','em','embed','i','iframe','img','input','ins','kbd','keygen','label','mark','meter','noscript','object','output','progress','q','ruby','s','samp','script','select','small','span','strong','sub','sup','textarea','time','u','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='command'">
            <xsl:sequence select="(()),(())"/>
         </xsl:when>
         <xsl:when test="$name='menu'">
            <xsl:sequence select="(()),(('li','a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:when test="$name='dialog'">
            <xsl:sequence select="(()),(('a','abbr','address','area','map','article','aside','audio','b','bdi','bdo','blockquote','br','button','canvas','cite','code','command','datalist','del','details','dfn','dialog','div','dl','em','embed','fieldset','figure','footer','form','h1','h2','h3','h4','h5','h6','header','hgroup','hr','i','iframe','img','input','ins','kbd','keygen','label','mark','menu','meter','nav','noscript','object','ol','output','p','pre','progress','q','ruby','s','samp','script','section','select','small','span','strong','style','sub','sup','table','textarea','time','u','ul','var','video','wbr'))"/>
         </xsl:when>
         <xsl:otherwise>
            <xsl:sequence select="()"/>
         </xsl:otherwise>
      </xsl:choose>
   </xsl:function>
                
</xsl:stylesheet>
